# Breakdown プロンプト

Issue #{{ISSUE_NUMBER}} の実装プランを並行作業可能な粒度で分解し、それぞれ GitHub Issue を作成して Milestone 「{{MILESTONE_TITLE}}」に追加してください。

## フェーズ1: プラン取得

`gh issue view {{ISSUE_NUMBER}} --comments` で Issue 本文とコメント一覧を取得し、
claude[bot] が投稿した最新の「## 実装プラン」を含むコメントを特定する。

## フェーズ2: タスク草案を作る（Issue はまだ作成しない）

プランを「並行作業可能な粒度」に分解してリストアップする。
各タスクに以下を明記すること：
- タスクの概要（何をするか）
- 並行可能な理由（なぜ他のタスクと同時に進められるか）
- 依存する先行タスク（あれば）

## フェーズ3: 自己レビュー（網羅性・並行性の検証）

草案を作ったら、以下のチェックを行い、問題があれば草案を修正してからフェーズ4へ進む：

**網羅性チェック**
- プランの全ステップが最低1つのタスクに対応しているか？
- 見落とされているステップはないか？

**並行性チェック**
- 「並行可能」としたタスク間に実は隠れた依存関係（共通ファイルの排他的変更、型定義の依存など）はないか？
- 依存がある場合は並行不可として整理し直す

**粒度チェック**
- 大きすぎるタスク（単独で数日以上かかるもの）はさらに分割できないか？
- 細かすぎるタスク（数分で終わるもの）は統合できないか？

## フェーズ4: Issue 作成と Milestone 追加

検証済み草案をもとに以下を実行する：

1. 各タスクを `gh issue create --milestone "{{MILESTONE_TITLE}}"` で作成する

   Issue のフォーマット：
   ```
   タイトル: <タスクの要点を簡潔に>

   ## 概要
   （このタスクが何をするか）

   ## 背景
   親 Issue: #{{ISSUE_NUMBER}}
   Milestone: {{MILESTONE_TITLE}}

   ## 実装メモ
   （プランから抜粋した関連ステップ・注意事項）

   ## 依存関係
   - 先行タスク: #<Issue 番号>（なければ省略）
   - 並行可能: #<Issue 番号>, #<Issue 番号>
   ```

2. 完了後、元 Issue #{{ISSUE_NUMBER}} に以下のサマリーをコメントする：
   ```
   ## タスク分解が完了しました

   以下の Issue を作成し、Milestone 「{{MILESTONE_TITLE}}」に追加しました：
   - #<番号> <タイトル>（並行可能: #<番号>, ...）
   - #<番号> <タイトル>（先行: #<番号> を待つ）
   ...

   **実装順序の目安**
   （並行・直列の関係を簡潔に）
   ```

**重要**: コードの実装・ファイルの書き込み・ブランチ操作は行わないこと。Issue の作成のみ行う。
