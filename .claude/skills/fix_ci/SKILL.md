---
name: fix_ci
description: CI の失敗を分析し最小限の修正を行います。GitHub Actions の失敗、テスト失敗、lint エラー、ビルドエラーの修正を依頼されたときに使用
---

# fix_ci

CI 失敗を最小パッチで直す。

## ワークフロー

### 1. エラーの取得

```bash
gh run view <run-id> --log-failed
```

### 2. エラーの分類と対応

| 種類 | 対応 |
|------|------|
| lint エラー | `--fix` で自動修正、または手動 |
| 型エラー | 型定義を修正 |
| テスト失敗 | 実装かテストを修正 |
| ビルドエラー | import、依存関係を確認 |
| 環境エラー | CI 設定、環境変数を確認 |

### 3. 原因分析

1. 直近の変更が原因か
2. 依存関係の変更
3. ローカルと CI の環境差
4. flaky test（時間、乱数依存）

### 4. 修正の原則

**最小パッチ**: CI を通すための最小限の変更。

**安全優先**: Stop 対象は触らない、テストを skip しない、`any` で握りつぶさない。

### 5. 確認

```bash
npm run lint && npm test && npm run build
```

## 出力フォーマット

```markdown
## エラー内容
[要点]

## 原因仮説
1. [最有力]
2. [次点]

## 修正内容
- `path/to/file.ts`: [修正内容]

## 確認結果
- [ ] lint: pass
- [ ] test: pass
- [ ] build: pass
```

## 2回続けて失敗したら

状況整理して停止:
- 何が起きているか
- 試したこと
- 次に試すこと

## このスキルでできないこと
- バグの根本原因調査（`/debug` を使用）
- 新機能の実装（`/implement` を使用）
